<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Bundesliga Saisonzielrechner</title>
    <script src="saisonziel.js" defer></script>
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">	
	<style>
	.collapsible {
	  background-color: #777;
	  color: white;
	  cursor: pointer;
	  text-align: left;
	}

	.active, .collapsible:hover {
	  background-color: #555;
	}

	.collapsible:after {
	  content: '\002B';
	  color: white;
	  font-weight: bold;
	  float: right;
	  margin-left: 5px;
	}

	.active:after {
	  content: "\2212";
	}

	.content {
	  max-height: 0;
	  overflow: hidden;
	  transition: max-height 0.2s ease-out;
	}
	</style>
</head>
<body>
<h1 class="w3-container">Saisonzielrechner</h1>
<div class="w3-container w3-padding-large">Haben wir den Klassenerhalt schon sicher? Können wir noch international spielen?</div>
<div class="w3-bar w3-orange" id="debug" style="display: none;">
  <span class="w3-bar-item">Debug Data:</span>
  <button class="w3-bar-item w3-button w3-hover-deep-orange tablink" onclick="league='bl1'; saison=2022; spieltag=0; updateData(ziel);" id="debug0">BL1 2022 0</button>
  <button class="w3-bar-item w3-button w3-hover-deep-orange tablink" onclick="league='bl1'; saison=2022; spieltag=10; updateData(ziel);" id="debug10">BL1 2022 10</button>
  <button class="w3-bar-item w3-button w3-hover-deep-orange tablink" onclick="league='bl1'; saison=2022; spieltag=26; updateData(ziel);" id="debug26">BL1 2022 26</button>
  <button class="w3-bar-item w3-button w3-hover-deep-orange tablink" onclick="league='bl1'; saison=2022; spieltag=30; updateData(ziel);" id="debug30">BL1 2022 30</button>
  <button class="w3-bar-item w3-button w3-hover-deep-orange tablink" onclick="league='bl1'; saison=2022; spieltag=32; updateData(ziel);" id="debug32">BL1 2022 32</button>
  <button class="w3-bar-item w3-button w3-hover-deep-orange tablink" onclick="league='bl1'; saison=2022; spieltag=33; updateData(ziel);" id="debug33">BL1 2022 33</button>
</div>
<div class="w3-container w3-tiny">&nbsp;</div>
<div class="w3-bar w3-teal">
  <span class="w3-bar-item">Saisonziel:</span>
  <button class="w3-bar-item w3-button w3-hover-cyan tablink w3-mobile" onclick="updateData('league');" id="league">Klassenerhalt</button>
  <button class="w3-bar-item w3-button w3-hover-cyan tablink w3-mobile" onclick="updateData('int');" id="int">International</button>
  <button class="w3-bar-item w3-button w3-hover-cyan tablink w3-mobile" onclick="updateData('cl');" id="cl">Champions League</button>
  <button class="w3-bar-item w3-button w3-hover-cyan tablink w3-mobile" onclick="updateData('win');" id="win">Meister</button>
</div>
<div class="w3-container w3-padding-large">Mannschaften, die aktuell in der Tabelle noch nicht auf einem Platz ihres Saisonziels stehen, benötigen <span id="Zielpunkte"></span> Punkte.<br /><span id="ind_ziel"></span></div>
<div id="zieltabelle" class="w3-container w3-padding-small">
	<table class="w3-table w3-striped w3-border">
		<tr>
			<td>Platz</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>1&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>2&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>3&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>4&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>5&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>6&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>7&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>8&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>9&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>10&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>11&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>12&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>13&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>14&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>15&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>16&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>17&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>18&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
	</table>
</div>
	
<button class="collapsible w3-bar w3-button w3-khaki">Legende</button>
<div class="content w3-container w3-white w3-small">
	<ul class="w3-ul w3-padding-small">
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt">Sp</div>
	  		<div class="w3-bar-item">Spieltag</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt">Pk</div>
	  		<div class="w3-bar-item">Punkte bisher</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt">Zi</div>
	  		<div class="w3-bar-item">Zielpunkte (zu erreichend für Saisonziel)<br />*) diese Punkte sind in den ausstehenden Spieltagen nicht mehr erreichbar,<br />werden aber der Vollständigkeit noch angezeigt.</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt">Fhlnd</div>
	  		<div class="w3-bar-item">Fehlende Punkte bis zum Saisonziel</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt;"><img src="icons/1.png" class="w3-bar-item"></div>
	  		<div class="w3-bar-item">Saisonziel erreicht</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt;"><img src="icons/2.png" class="w3-bar-item"></div>
	  		<div class="w3-bar-item">Saisonziel aus eigener Kraft erreichbar</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt;"><img src="icons/3.png" class="w3-bar-item"></div>
	  		<div class="w3-bar-item">Saisonziel nur noch mit Schützenhilfe erreichbar</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt;"><img src="icons/4.png" class="w3-bar-item"></div>
	  		<div class="w3-bar-item">Saisonziel verpasst</div>
		</li>
  		<li class="w3-bar w3-padding-small">
	  		<div class="w3-bar-item" style="width:50pt">&nbsp;</div>
	  		<div class="w3-bar-item w3-small">Icons von <a target="_blank" href="https://icons8.com">Icons8</a></div>
		</li>
	</ul>
</div>

<button class="collapsible w3-bar w3-button w3-khaki">Berechnung</button>
<div class="content w3-container w3-white">
  	<p>Die Berechnungsmethodik basiert auf dem mathematischen Rätsel von <a href="https://www.spektrum.de/raetsel/meister-und-absteiger/1777404" target="_blank">Heinrich Hemme: Welches ist die höchste Punktzahl, mit der man absteigen kann?</a>. Dabei werden alle zu erreichenden Punkte zwischen den Plätzen 1-16 gleichverteilt.</p>
  	<p>Ich habe diese Methodik wie folgt adaptiert: Wenn der Absteiger die höchste maximale Punktzahl erreicht, muss der erste Nichtabsteiger mindestens einen Punkt mehr haben. Ich lasse hier die Tordifferenz bewusst außer acht, da die Frage, ab wann eine bestimmte Differenz ausreicht, wohl nicht abschließend geklärt werden kann, und es die Berechnung vereinfacht. Außerdem geht es mir darum, ob das Saisonziel aus eigener Kraft erreicht werden kann.</p>
  	<p>Eine weitere Adaption war notwendig, da Heinrich Hemmes Berechnung den Idealzustand am Saisonbeginn simuliert. Mit fortlaufendem Saisonverlauf ändern sich allerdings die Situation, da Mannschaften im oberen Teil der Tabelle bereits Punkte einfahren, teilweise natürlich auch über das Ziel hinaus. Dadurch werden bei der Verteilung der noch ausstehenden Punkte die bereits erzielten Punkte über Platz 16 zunächst herausgerechnet. Schmatisch ergibt sich damit folgende Berechnung der zu erreichenden Punktzahl:</p>
  	<p class="w3-code">
(<br />
&nbsp;(((ausstehende Spiele - Spiele von Mannschaften auf Platz 17-18 gegeneinander) * 3) <br />
&nbsp;&nbsp;- Summe aller bereits erreichten Punkte über letztem Abstiegsplatz <br />
&nbsp;) <br />
&nbsp;/ Anzahl Nichtabstiegs- und letzte Abstiegsmannschaft<br />
) <br />
+ Punkte beste noch nicht gesichert gerettete Mannschaft <br />
+ 1</p>
  	<p>In diese Berechnungen werden nur Mannschaften einbezogen, die  noch nicht gesichert abgestiegen oder gerettet sind. Die selbe Methodik lässt sich auch auf das Erreichen der internationalen Plätze, der Champions League, und sogar des Meistertitels anwenden.</p>
  	<p>Die für das jeweilige Saisonziel zu erreichende Punktzahl für Mannschaften, die noch keinen solchen Platz innehaben (also sich unter dem Strich befinden), muss man wie folgt interpretieren: Wieviele Punkte sind notwendig, um auf jeden Fall noch das Saisonziel zu erreichen. Mannschaften, die einen solchen Platz schon einnehmen, müssen lediglich diejenige Anzahl an Punkten erreichen, die an den verbleibenden Spieltagen von besten nicht-qualifizierten nicht mehr eingeholt werden können. Diese Unterscheidung ist notwendig, da solche Mannschaften anderen keine Punkte mehr wegnehmen müssen.</p>
  	<p><a href="javascript:toggleDebug();">Aktiviere/deaktiviere den Debug-Modus</a>, um verschiedene Beispielspieltage aus der Saison 2022/2023 zu testen.</p>
  	<p>Die Daten werden übrigens per API von <a href="https://www.openligadb.de" target="_blank">OpenLigaDB</a> bereitgestellt, die Icons von <a target="_blank" href="https://icons8.com">Icons8</a>.</p>
</div>
<button class="collapsible w3-bar w3-button w3-khaki">Hintergrund</button>
<div class="content w3-container w3-white">
  	<p>Als Fan des VfB Stuttgarts erlebe ich im Herbst/Winter 2023 eine lang vermisste Euphorie ob der guten Ergebnisse der Mannschaft. Dennoch haben die letzten Jahre mit zwei Abstiegen und vielen bangen Momenten im Abstiegskampf tiefe Narben hinterlassen, so dass es erstmal gilt ein solches erneutes Szenario nicht wieder zu erleben. Und während es Erfahrungswerte gibt ("mit 40 Punkten ist man gerettet"), möchte ich lieber ganz genau wissen, ab wann der VfB nichts mehr mit dem Abstieg zu tun hat. Und so entstand dieses kleine Projekt.</p>
</div>
<div class="w3-container w3-white">
  	<p>&nbsp;</p>
</div>
<script>
var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.maxHeight){
      content.style.maxHeight = null;
    } else {
      content.style.maxHeight = content.scrollHeight + "px";
    } 
  });
}
</script>

</body>
</html>
